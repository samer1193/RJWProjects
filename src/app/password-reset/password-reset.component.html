<app-header></app-header>
<div class = "container">
  <div class="col-sm-8 col-sm-offset-2">
      <div class="col-md col-md-offset-1">
        <h1>
        Reset password step {{step}} of 5
        </h1>
        <form *ngIf = "step == 1" (ngSubmit)="f.form.valid && validateUser()" #f="ngForm" novalidate>
          <div class = "form-group" >
            <label for = "userName">Username</label>
            <input type = text class = "form-control" name="userName" [(ngModel)] = "model.userName" #userName = "ngModel" required autofocus placeholder="User Name"/>
            <div *ngIf="f.submitted && !userName.valid" class="help-block" >Username is required</div>
            <h4 class="danger" *ngIf = "errorMsg">{{errorMsg}}</h4> 
          </div>
          <div class="form-group">
              <button [disabled]="loading" class="btn btn-primary" style="color:white; background-color: #009999;">Submit</button>
          </div>
        </form>
        <form *ngIf = "step == 2" (ngSubmit)="f.form.valid && verifySecurityQuest()" #f="ngForm" novalidate>
            <div class="form-group">
                <label class='col-lg-2 control-label' for="securityQ1">Question 1:</label>
                <div class='col-lg-10'>
                    <span class="form-control" id="securityQ1" name="securityQ1">{{ securityQ.securityQuestion1.question }}</span>
                </div>
            </div>
            <div class="form-group">
                <label class='col-lg-2 control-label' for="securityQ1">Answer 1:</label>
                <div class='col-lg-10'>
                    <input type="text" class="form-control" [(ngModel)] = "model.answer1" id="answer1" name="answer1" required autofocus empty-to-null>
                    <h4 class="danger" *ngIf = "errorMsg == 'Security answer 1 is incorrect.'" >{{errorMsg}}</h4> 
                </div>
            </div>
            <div class="form-group">
                <label class='col-lg-2 control-label' for="securityQ2">Question 2:</label>
                <div class='col-lg-10'>
                    <span class="form-control" id="securityQ2" name="securityQ2">{{ securityQ.securityQuestion2.question }}</span>
                </div>
            </div>
            <div class="form-group">
                <label class='col-lg-2 control-label' for="securityQ1">Answer 2:</label>
                <div class='col-lg-10'>
                    <input type="text" class="form-control" [(ngModel)] = "model.answer2" id="answer2" name="answer2" required autofocus empty-to-null>
                    <h4 class="danger" *ngIf = "errorMsg == 'Security answer 2 is incorrect.'" >{{errorMsg}}</h4> 
                </div>
            </div>
            <div class="form-group">
                <label class='col-lg-2 control-label' for="securityQ3">Question 3:</label>
                <div class='col-lg-10'>
                    <span class="form-control" id="securityQ3" name="securityQ3">{{ securityQ.securityQuestion3.question }}</span>
                </div>
            </div>
            <div class="form-group">
                <label class='col-lg-2 control-label' for="securityQ3">Answer 3:</label>
                <div class='col-lg-10'>
                    <input type="text" class="form-control" [(ngModel)] = "model.answer3" id="answer3" name="answer3" required autofocus empty-to-null>
                    <h4 class="danger" *ngIf = "errorMsg == 'Security answer 3 is incorrect.'" >{{errorMsg}}</h4> 
                </div>
            </div>
            <div class="form-group">
                <button [disabled]="loading" class="btn btn-primary" style="color:white; background-color: #009999;">Submit</button>
            </div>
          </form>
          <div *ngIf ="step == 3">
              <p style="color:#676a6c">Confirmation email has been sent.<br> Please check your email to reset your password.</p>
          </div> 
          <form *ngIf = "step == 4" (ngSubmit)="f.form.valid && resetPassword()" #f="ngForm" novalidate>
            <div class='form-group'>
              <label for='password' class="col-lg-2 control-label">New password:</label>
              <div class='col-lg-10'>
                  <input type='password' name='password' id='password' class='form-control' [ngModel] = "securityQ?.password" (ngModelChange) = "securityQ.password = $event" minlength="6" required>
                  <span class="text-danger" ng-if='vm.frm3.password.$invalid && vm.frm3.password.$touched'><br></span>
              </div>
          </div>
          <div class='form-group '>
              <label for='confirmPassword' class="col-lg-2 control-label">Confirm new password:</label>
              <div class='col-lg-10'>
                  <input type='password' name='confirmpassword' id='confirmpassword' class='form-control' [ngModel] = "securityQ?.confirmPassword" (ngModelChange) = "securityQ.confirmPassword = $event"
                      minlength="6" required password-verify="vm.frm3.password"><br><br>
              </div>
              <h4 class="danger" *ngIf = "errorMsg" >{{errorMsg}}</h4> 
              <p>Note: Password must be at least 6 characters long.</p>
          </div>
          <div class="form-group">
            <button [disabled]="loading" class="btn btn-primary" style="color:white; background-color: #009999;">Submit</button>
        </div>
          </form>
        <div *ngIf = "step == 5">
            <p style="color:#676a6c">Your password has been reset. <a href = 'https://carrierportal.rjwgroup.com'> Click here to login </a></p>
        </div>
      
</div>
</div>
</div>
<div id = 'wrapper'>
<div id ="footer">
<app-footer></app-footer>
</div>
</div>